import{Buffer as e}from"buffer";import r from"crypto";export default function(t,n="aes-256-cbc",o){if(!t||0==t.length)throw new Error("Must be set a password for encryption");return{name:"Encryption",created(){this.logger.info(`The transmission is ENCRYPTED by '${n}'.`)},transporterSend:c=>(i,a,p)=>{const s=o?r.createCipheriv(n,t,o):r.createCipher(n,t),f=e.concat([s.update(a),s.final()]);return c(i,f,p)},transporterReceive:c=>(i,a,p)=>{const s=o?r.createDecipheriv(n,t,o):r.createDecipher(n,t),f=e.concat([s.update(a),s.final()]);return c(i,f,p)}}}
//# sourceMappingURL=encryption.js.map
