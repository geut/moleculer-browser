{"version":3,"file":"metrics.js","sources":["../../../../../src/moleculer/src/middlewares/metrics.js"],"sourcesContent":["/*\n * moleculer\n * Copyright (c) 2020 MoleculerJS (https://github.com/moleculerjs/moleculer)\n * MIT Licensed\n */\n\n\"use strict\";\n\nconst { METRIC }\t= require(\"../metrics\");\n\nmodule.exports = function MetricsMiddleware(broker) {\n\tconst metrics = broker.metrics;\n\n\tfunction getActionHandler(type, actionDef, next) {\n\t\tconst action = actionDef.name;\n\t\tconst service = actionDef.service ? actionDef.service.fullName : null;\n\n\t\treturn function metricsMiddleware(ctx) {\n\t\t\tconst caller = ctx.caller;\n\n\t\t\tmetrics.increment(METRIC.MOLECULER_REQUEST_TOTAL, { service, action, caller, type });\n\t\t\tmetrics.increment(METRIC.MOLECULER_REQUEST_ACTIVE, { service, action, caller, type });\n\t\t\tmetrics.increment(METRIC.MOLECULER_REQUEST_LEVELS, { service, action, caller, level: ctx.level });\n\t\t\tconst timeEnd = metrics.timer(METRIC.MOLECULER_REQUEST_TIME, { service, action, caller, type });\n\n\t\t\t// Call the next handler\n\t\t\treturn next(ctx).then(res => {\n\t\t\t\ttimeEnd();\n\t\t\t\tmetrics.decrement(METRIC.MOLECULER_REQUEST_ACTIVE, { service, action, caller, type });\n\t\t\t\treturn res;\n\t\t\t}).catch(err => {\n\t\t\t\ttimeEnd();\n\t\t\t\tmetrics.decrement(METRIC.MOLECULER_REQUEST_ACTIVE, { service, action, caller, type });\n\t\t\t\tmetrics.increment(METRIC.MOLECULER_REQUEST_ERROR_TOTAL, {\n\t\t\t\t\tservice,\n\t\t\t\t\taction,\n\t\t\t\t\tcaller,\n\t\t\t\t\ttype,\n\t\t\t\t\terrorName: err ? err.name : null,\n\t\t\t\t\terrorCode: err ? err.code : null,\n\t\t\t\t\terrorType: err ? err.type : null\n\t\t\t\t});\n\t\t\t\tthrow err;\n\t\t\t});\n\n\t\t};\n\t}\n\n\treturn {\n\t\tname: \"Metrics\",\n\n\t\tcreated() {\n\t\t\tif (broker.isMetricsEnabled()) {\n\t\t\t\t// --- MOLECULER REQUEST METRICS ---\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_REQUEST_TOTAL, type: METRIC.TYPE_COUNTER, labelNames: [\"service\", \"action\", \"type\", \"caller\"], unit: METRIC.UNIT_REQUEST, description: \"Number of requests\", rate: true });\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_REQUEST_ACTIVE, type: METRIC.TYPE_GAUGE, labelNames: [\"service\", \"action\", \"type\", \"caller\"], unit: METRIC.UNIT_REQUEST, description: \"Number of active requests\" });\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_REQUEST_ERROR_TOTAL, type: METRIC.TYPE_COUNTER, labelNames: [\"service\", \"action\", \"type\", \"caller\", \"errorName\", \"errorCode\", \"errorType\"], unit: METRIC.UNIT_REQUEST, description: \"Number of request errors\", rate: true });\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_REQUEST_TIME, type: METRIC.TYPE_HISTOGRAM, labelNames: [\"service\", \"action\", \"type\", \"caller\"], quantiles: true, buckets: true, unit: METRIC.UNIT_MILLISECONDS, description: \"Request times in milliseconds\", rate: true });\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_REQUEST_LEVELS, type: METRIC.TYPE_COUNTER, labelNames: [\"level\"], unit: METRIC.UNIT_REQUEST, description: \"Number of requests by context level\" });\n\t\t\t\t//metrics.register({ name: METRIC.MOLECULER_REQUEST_DIRECTCALL_TOTAL, type: METRIC.TYPE_COUNTER, labelNames: [\"action\"], unit: METRIC.UNIT_REQUEST, description: \"Number of direct calls\", rate: true });\n\t\t\t\t//metrics.register({ name: METRIC.MOLECULER_REQUEST_MULTICALL_TOTAL, type: METRIC.TYPE_COUNTER, unit: METRIC.UNIT_REQUEST, description: \"Number of multicalls\", rate: true });\n\n\t\t\t\t// --- MOLECULER EVENTS METRICS ---\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_EVENT_EMIT_TOTAL, type: METRIC.TYPE_COUNTER, labelNames: [\"event\", \"groups\"], unit: METRIC.UNIT_EVENT, description: \"Number of emitted events\", rate: true });\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_EVENT_BROADCAST_TOTAL, type: METRIC.TYPE_COUNTER, labelNames: [\"event\", \"groups\"], unit: METRIC.UNIT_EVENT, description: \"Number of broadcast events\", rate: true });\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_EVENT_BROADCASTLOCAL_TOTAL, type: METRIC.TYPE_COUNTER, labelNames: [\"event\", \"groups\"], unit: METRIC.UNIT_EVENT, description: \"Number of local broadcast events\", rate: true });\n\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_EVENT_RECEIVED_TOTAL, type: METRIC.TYPE_COUNTER, labelNames: [\"service\", \"group\", \"event\", \"caller\"], unit: METRIC.UNIT_EVENT, description: \"Number of received events\", rate: true });\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_EVENT_RECEIVED_ACTIVE, type: METRIC.TYPE_GAUGE, labelNames: [\"service\", \"group\", \"event\", \"caller\"], unit: METRIC.UNIT_REQUEST, description: \"Number of active event executions\" });\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_EVENT_RECEIVED_ERROR_TOTAL, type: METRIC.TYPE_COUNTER, labelNames: [\"service\", \"group\", \"event\", \"caller\", \"errorName\", \"errorCode\", \"errorType\"], unit: METRIC.UNIT_REQUEST, description: \"Number of event execution errors\", rate: true });\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_EVENT_RECEIVED_TIME, type: METRIC.TYPE_HISTOGRAM, labelNames: [\"service\", \"group\", \"event\", \"caller\"], quantiles: true, buckets: true, unit: METRIC.UNIT_MILLISECONDS, description: \"Execution time of events in milliseconds\", rate: true });\n\n\t\t\t\t// --- MOLECULER TRANSIT METRICS ---\n\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_TRANSIT_PUBLISH_TOTAL, type: METRIC.TYPE_COUNTER, labelNames: [\"type\"], unit: METRIC.UNIT_PACKET, description: \"Number of published packets\", rate: true });\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_TRANSIT_RECEIVE_TOTAL, type: METRIC.TYPE_COUNTER, labelNames: [\"type\"], unit: METRIC.UNIT_PACKET, description: \"Number of received packets\", rate: true });\n\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_TRANSIT_REQUESTS_ACTIVE, type: METRIC.TYPE_GAUGE, unit: METRIC.UNIT_REQUEST, description: \"Number of active requests\" });\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_TRANSIT_STREAMS_SEND_ACTIVE, type: METRIC.TYPE_GAUGE, unit: METRIC.UNIT_STREAM, description: \"Number of active sent streams\" });\n\t\t\t\t//metrics.register({ name: METRIC.MOLECULER_TRANSIT_STREAMS_RECEIVE_ACTIVE, type: METRIC.TYPE_GAUGE, description: \"\" });\n\n\t\t\t\t// --- MOLECULER TRANSPORTER METRICS ---\n\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_TRANSPORTER_PACKETS_SENT_TOTAL, type: METRIC.TYPE_COUNTER, unit: METRIC.UNIT_PACKET, description: \"Number of sent packets\", rate: true });\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_TRANSPORTER_PACKETS_SENT_BYTES, type: METRIC.TYPE_COUNTER, unit: METRIC.UNIT_BYTE, description: \"Number of sent bytes\", rate: true });\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_TRANSPORTER_PACKETS_RECEIVED_TOTAL, type: METRIC.TYPE_COUNTER, unit: METRIC.UNIT_PACKET, description: \"Number of received packets\", rate: true });\n\t\t\t\tmetrics.register({ name: METRIC.MOLECULER_TRANSPORTER_PACKETS_RECEIVED_BYTES, type: METRIC.TYPE_COUNTER, unit: METRIC.UNIT_BYTE, description: \"Number of received bytes\", rate: true });\n\t\t\t}\n\t\t},\n\n\t\tlocalAction(next, action) {\n\t\t\tif (broker.isMetricsEnabled())\n\t\t\t\treturn getActionHandler(\"local\", action, next);\n\n\t\t\treturn next;\n\t\t},\n\n\t\tremoteAction(next, action) {\n\t\t\tif (broker.isMetricsEnabled())\n\t\t\t\treturn getActionHandler(\"remote\", action, next);\n\n\t\t\treturn next;\n\t\t},\n\n\t\t// Wrap local event handlers\n\t\tlocalEvent(next, event) {\n\t\t\tconst service = event.service ? event.service.name : null;\n\t\t\tif (broker.isMetricsEnabled()) {\n\t\t\t\treturn function metricsMiddleware(ctx) {\n\t\t\t\t\tconst group = event.group || service;\n\t\t\t\t\tmetrics.increment(METRIC.MOLECULER_EVENT_RECEIVED_TOTAL, { service, event: ctx.eventName, group, caller: ctx.caller });\n\t\t\t\t\tmetrics.increment(METRIC.MOLECULER_EVENT_RECEIVED_ACTIVE, { service, event: ctx.eventName, group, caller: ctx.caller });\n\t\t\t\t\tconst timeEnd = metrics.timer(METRIC.MOLECULER_EVENT_RECEIVED_TIME, { service, event: ctx.eventName, group, caller: ctx.caller });\n\t\t\t\t\treturn next.apply(this, arguments).then(res => {\n\t\t\t\t\t\ttimeEnd();\n\t\t\t\t\t\tmetrics.decrement(METRIC.MOLECULER_EVENT_RECEIVED_ACTIVE, { service, event: ctx.eventName, group, caller: ctx.caller });\n\t\t\t\t\t\treturn res;\n\t\t\t\t\t}).catch(err => {\n\t\t\t\t\t\ttimeEnd();\n\t\t\t\t\t\tmetrics.decrement(METRIC.MOLECULER_EVENT_RECEIVED_ACTIVE, { service, event: ctx.eventName, group, caller: ctx.caller });\n\t\t\t\t\t\tmetrics.increment(METRIC.MOLECULER_EVENT_RECEIVED_ERROR_TOTAL, {\n\t\t\t\t\t\t\tservice, event: ctx.eventName, group, caller: ctx.caller,\n\t\t\t\t\t\t\terrorName: err ? err.name : null,\n\t\t\t\t\t\t\terrorCode: err ? err.code : null,\n\t\t\t\t\t\t\terrorType: err ? err.type : null\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthrow err;\n\t\t\t\t\t});\n\t\t\t\t}.bind(this);\n\t\t\t}\n\n\t\t\treturn next;\n\t\t},\n\n\t\t// Wrap broker.emit method\n\t\temit(next) {\n\t\t\tif (broker.isMetricsEnabled()) {\n\t\t\t\treturn function metricsMiddleware(/* event, payload */) {\n\t\t\t\t\tmetrics.increment(METRIC.MOLECULER_EVENT_EMIT_TOTAL, { event: arguments[0] });\n\t\t\t\t\treturn next.apply(this, arguments);\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn next;\n\t\t},\n\n\t\t// Wrap broker.broadcast method\n\t\tbroadcast(next) {\n\t\t\tif (broker.isMetricsEnabled()) {\n\t\t\t\treturn function metricsMiddleware(/* event, payload */) {\n\t\t\t\t\tmetrics.increment(METRIC.MOLECULER_EVENT_BROADCAST_TOTAL, { event: arguments[0] });\n\t\t\t\t\treturn next.apply(this, arguments);\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn next;\n\t\t},\n\n\t\t// Wrap broker.broadcastLocal method\n\t\tbroadcastLocal(next) {\n\t\t\tif (broker.isMetricsEnabled()) {\n\t\t\t\treturn function metricsMiddleware(/* event, payload */) {\n\t\t\t\t\tmetrics.increment(METRIC.MOLECULER_EVENT_BROADCASTLOCAL_TOTAL, { event: arguments[0] });\n\t\t\t\t\treturn next.apply(this, arguments);\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn next;\n\t\t},\n\n\t\t// When transit publishing a packet\n\t\ttransitPublish(next) {\n\t\t\tconst transit = this;\n\t\t\tif (broker.isMetricsEnabled()) {\n\t\t\t\treturn function metricsMiddleware(/* packet */) {\n\t\t\t\t\tmetrics.increment(METRIC.MOLECULER_TRANSIT_PUBLISH_TOTAL, { type: arguments[0].type });\n\n\t\t\t\t\tconst p = next.apply(this, arguments);\n\n\t\t\t\t\tmetrics.increment(METRIC.MOLECULER_TRANSIT_REQUESTS_ACTIVE, null, transit.pendingRequests.size);\n\t\t\t\t\t//metrics.increment(METRIC.MOLECULER_TRANSIT_STREAMS_RECEIVE_ACTIVE, null, transit.);\n\t\t\t\t\tmetrics.increment(METRIC.MOLECULER_TRANSIT_STREAMS_SEND_ACTIVE, null, transit.pendingReqStreams.size + this.pendingResStreams.size);\n\n\t\t\t\t\treturn p;\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn next;\n\t\t},\n\n\t\t// When transit receives & handles a packet\n\t\ttransitMessageHandler(next) {\n\t\t\tif (broker.isMetricsEnabled()) {\n\t\t\t\treturn function metricsMiddleware(/* cmd, packet */) {\n\t\t\t\t\tmetrics.increment(METRIC.MOLECULER_TRANSIT_RECEIVE_TOTAL, { type: arguments[0] });\n\t\t\t\t\treturn next.apply(this, arguments);\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn next;\n\t\t},\n\n\t\t// When transporter send data\n\t\ttransporterSend(next) {\n\t\t\tif (broker.isMetricsEnabled()) {\n\t\t\t\treturn function metricsMiddleware(/* topic, data, meta */) {\n\t\t\t\t\tconst data = arguments[1];\n\t\t\t\t\tmetrics.increment(METRIC.MOLECULER_TRANSPORTER_PACKETS_SENT_TOTAL);\n\t\t\t\t\tmetrics.increment(METRIC.MOLECULER_TRANSPORTER_PACKETS_SENT_BYTES, null, data && data.length ? data.length : 0);\n\t\t\t\t\treturn next.apply(this, arguments);\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn next;\n\t\t},\n\n\t\t// When transporter received data\n\t\ttransporterReceive(next) {\n\t\t\tif (broker.isMetricsEnabled()) {\n\t\t\t\treturn function metricsMiddleware(/* cmd, data, s */) {\n\t\t\t\t\tconst data = arguments[1];\n\t\t\t\t\tmetrics.increment(METRIC.MOLECULER_TRANSPORTER_PACKETS_RECEIVED_TOTAL);\n\t\t\t\t\tmetrics.increment(METRIC.MOLECULER_TRANSPORTER_PACKETS_RECEIVED_BYTES, null, data && data.length ? data.length : 0);\n\t\t\t\t\treturn next.apply(this, arguments);\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn next;\n\t\t}\n\n\t};\n};\n"],"names":["require$$0"],"mappings":"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"}