{"version":3,"file":"base.js","sources":["../../../../../src/moleculer/src/loggers/base.js"],"sourcesContent":["/*\n * moleculer\n * Copyright (c) 2019 MoleculerJS (https://github.com/moleculerjs/moleculer)\n * MIT Licensed\n */\n\n\"use strict\";\n\nconst _ = require(\"lodash\");\nconst { match, isObject, isString }\t= require(\"../utils\");\n\nconst LEVELS = [\"fatal\", \"error\", \"warn\", \"info\", \"debug\", \"trace\"];\n\n/**\n * Logger base class.\n *\n * @class BaseLogger\n */\nclass BaseLogger {\n\n\t/**\n\t * Creates an instance of BaseLogger.\n\t *\n\t * @param {Object} opts\n\t * @memberof BaseLogger\n\t */\n\tconstructor(opts) {\n\t\tthis.opts = _.defaultsDeep(opts, {\n\t\t\tlevel: \"info\",\n\t\t\tcreateLogger: null\n\t\t});\n\t\tthis.Promise = Promise; // default promise before logger is initialized\n\t}\n\n\t/**\n\t * Initialize logger.\n\t *\n\t * @param {LoggerFactory} loggerFactory\n\t */\n\tinit(loggerFactory)  {\n\t\tthis.loggerFactory = loggerFactory;\n\t\tthis.broker = this.loggerFactory.broker;\n\t\tthis.Promise = this.broker.Promise;\n\t}\n\n\t/**\n\t * Stopping logger\n\t */\n\tstop() {\n\t\treturn this.Promise.resolve();\n\t}\n\n\tgetLogLevel(mod) {\n\t\tmod = mod ? mod.toUpperCase() : \"\";\n\n\t\tconst level = this.opts.level;\n\t\tif (isString(level))\n\t\t\treturn level;\n\n\t\tif (isObject(level)) {\n\t\t\tif (level[mod])\n\t\t\t\treturn level[mod];\n\n\t\t\t// Find with matching\n\t\t\tconst key = Object.keys(level).find(m => match(mod, m) && m !== \"**\");\n\t\t\tif (key)\n\t\t\t\treturn level[key];\n\t\t\telse if (level[\"**\"]) {\n\t\t\t\treturn level[\"**\"];\n\t\t\t}\n\t\t}\n\n\t\t/* istanbul ignore next */\n\t\treturn null;\n\t}\n\n\tgetLogHandler(/*bindings*/) {\n\t\treturn null;\n\t}\n}\n\nBaseLogger.LEVELS = LEVELS;\n\nmodule.exports = BaseLogger;\n"],"names":["require$$0"],"mappings":";;;AASA,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAGA,OAAmB,CAAC;AAC1D;AACA,MAAM,MAAM,GAAG,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,UAAU,CAAC;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,WAAW,CAAC,IAAI,EAAE;AACnB,EAAE,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC,YAAY,CAAC,IAAI,EAAE;AACnC,GAAG,KAAK,EAAE,MAAM;AAChB,GAAG,YAAY,EAAE,IAAI;AACrB,GAAG,CAAC,CAAC;AACL,EAAE,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;AACzB,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,IAAI,CAAC,aAAa,GAAG;AACtB,EAAE,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;AACrC,EAAE,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC;AAC1C,EAAE,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC;AACrC,EAAE;AACF;AACA;AACA;AACA;AACA,CAAC,IAAI,GAAG;AACR,EAAE,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;AAChC,EAAE;AACF;AACA,CAAC,WAAW,CAAC,GAAG,EAAE;AAClB,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,WAAW,EAAE,GAAG,EAAE,CAAC;AACrC;AACA,EAAE,MAAM,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;AAChC,EAAE,IAAI,QAAQ,CAAC,KAAK,CAAC;AACrB,GAAG,OAAO,KAAK,CAAC;AAChB;AACA,EAAE,IAAI,QAAQ,CAAC,KAAK,CAAC,EAAE;AACvB,GAAG,IAAI,KAAK,CAAC,GAAG,CAAC;AACjB,IAAI,OAAO,KAAK,CAAC,GAAG,CAAC,CAAC;AACtB;AACA;AACA,GAAG,MAAM,GAAG,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,IAAI,CAAC,CAAC;AACzE,GAAG,IAAI,GAAG;AACV,IAAI,OAAO,KAAK,CAAC,GAAG,CAAC,CAAC;AACtB,QAAQ,IAAI,KAAK,CAAC,IAAI,CAAC,EAAE;AACzB,IAAI,OAAO,KAAK,CAAC,IAAI,CAAC,CAAC;AACvB,IAAI;AACJ,GAAG;AACH;AACA;AACA,EAAE,OAAO,IAAI,CAAC;AACd,EAAE;AACF;AACA,CAAC,aAAa,eAAe;AAC7B,EAAE,OAAO,IAAI,CAAC;AACd,EAAE;AACF,CAAC;AACD;AACA,UAAU,CAAC,MAAM,GAAG,MAAM,CAAC;AAC3B;QACc,GAAG;;;;"}