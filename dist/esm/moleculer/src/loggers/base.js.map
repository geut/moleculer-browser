{"version":3,"file":"base.js","sources":["../../../../../src/moleculer/src/loggers/base.js"],"sourcesContent":["/*\n * moleculer\n * Copyright (c) 2019 MoleculerJS (https://github.com/moleculerjs/moleculer)\n * MIT Licensed\n */\n\n\"use strict\";\n\nconst _ = require(\"lodash\");\nconst { match, isObject, isString }\t= require(\"../utils\");\n\nconst LEVELS = [\"fatal\", \"error\", \"warn\", \"info\", \"debug\", \"trace\"];\n\n/**\n * Logger base class.\n *\n * @class BaseLogger\n */\nclass BaseLogger {\n\n\t/**\n\t * Creates an instance of BaseLogger.\n\t *\n\t * @param {Object} opts\n\t * @memberof BaseLogger\n\t */\n\tconstructor(opts) {\n\t\tthis.opts = _.defaultsDeep(opts, {\n\t\t\tlevel: \"info\",\n\t\t\tcreateLogger: null\n\t\t});\n\t\tthis.Promise = Promise; // default promise before logger is initialized\n\t}\n\n\t/**\n\t * Initialize logger.\n\t *\n\t * @param {LoggerFactory} loggerFactory\n\t */\n\tinit(loggerFactory)  {\n\t\tthis.loggerFactory = loggerFactory;\n\t\tthis.broker = this.loggerFactory.broker;\n\t\tthis.Promise = this.broker.Promise;\n\t}\n\n\t/**\n\t * Stopping logger\n\t */\n\tstop() {\n\t\treturn this.Promise.resolve();\n\t}\n\n\tgetLogLevel(mod) {\n\t\tmod = mod ? mod.toUpperCase() : \"\";\n\n\t\tconst level = this.opts.level;\n\t\tif (isString(level))\n\t\t\treturn level;\n\n\t\tif (isObject(level)) {\n\t\t\tif (level[mod])\n\t\t\t\treturn level[mod];\n\n\t\t\t// Find with matching\n\t\t\tconst key = Object.keys(level).find(m => match(mod, m) && m !== \"**\");\n\t\t\tif (key)\n\t\t\t\treturn level[key];\n\t\t\telse if (level[\"**\"]) {\n\t\t\t\treturn level[\"**\"];\n\t\t\t}\n\t\t}\n\n\t\t/* istanbul ignore next */\n\t\treturn null;\n\t}\n\n\tgetLogHandler(/*bindings*/) {\n\t\treturn null;\n\t}\n}\n\nBaseLogger.LEVELS = LEVELS;\n\nmodule.exports = BaseLogger;\n"],"names":["match","isObject","isString","require$$0","BaseLogger","[object Object]","opts","this","_","defaultsDeep","level","createLogger","Promise","loggerFactory","broker","resolve","mod","toUpperCase","key","Object","keys","find","m","LEVELS"],"mappings":"iDASA,MAAMA,MAAEA,EAAKC,SAAEA,EAAQC,SAAEA,GAAaC,EAStC,MAAMC,EAQLC,YAAYC,GACXC,KAAKD,KAAOE,EAAEC,aAAaH,EAAM,CAChCI,MAAO,OACPC,aAAc,OAEfJ,KAAKK,QAAUA,QAQhBP,KAAKQ,GACJN,KAAKM,cAAgBA,EACrBN,KAAKO,OAASP,KAAKM,cAAcC,OACjCP,KAAKK,QAAUL,KAAKO,OAAOF,QAM5BP,OACC,OAAOE,KAAKK,QAAQG,UAGrBV,YAAYW,GACXA,EAAMA,EAAMA,EAAIC,cAAgB,GAEhC,MAAMP,EAAQH,KAAKD,KAAKI,MACxB,GAAIR,EAASQ,GACZ,OAAOA,EAER,GAAIT,EAASS,GAAQ,CACpB,GAAIA,EAAMM,GACT,OAAON,EAAMM,GAGd,MAAME,EAAMC,OAAOC,KAAKV,GAAOW,MAAKC,GAAKtB,EAAMgB,EAAKM,IAAY,OAANA,IAC1D,GAAIJ,EACH,OAAOR,EAAMQ,GACT,GAAIR,EAAM,MACd,OAAOA,EAAM,MAKf,OAAO,KAGRL,gBACC,OAAO,MAITD,EAAWmB,OAtEI,CAAC,QAAS,QAAS,OAAQ,OAAQ,QAAS,eAwE1CnB"}