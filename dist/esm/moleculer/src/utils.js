import e from"kleur";import t from"../../process.js";import{setTimeout as r}from"timers-browserify";import n from"path";import o from"es6-error";import*as i from"../../os.js";import s from"fs";const a=[];for(let e=0;e<256;e++)a[e]=(e<16?"0":"")+e.toString(16);const c=new Map,f=[],l={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},u=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;class p extends o{}const h=["h","m","s","ms","μs","ns"],m=[36e5,6e4,1e3,1,.001,1e-6],d={isFunction:e=>"function"==typeof e,isString:e=>"string"==typeof e||e instanceof String,isObject:e=>null!==e&&"object"==typeof e&&!(e instanceof String),isPlainObject:e=>null!=e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e)),flatten:e=>Array.prototype.reduce.call(e,((e,t)=>e.concat(t)),[]),humanize(e){if(null==e)return"?";for(let t=0;t<m.length;t++){const r=e/m[t];if(r>=1)return""+Math.floor(r)+h[t]}return"now"},generateToken(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return a[255&e]+a[e>>8&255]+a[e>>16&255]+a[e>>24&255]+"-"+a[255&t]+a[t>>8&255]+"-"+a[t>>16&15|64]+a[t>>24&255]+"-"+a[63&r|128]+a[r>>8&255]+"-"+a[r>>16&255]+a[r>>24&255]+a[255&n]+a[n>>8&255]+a[n>>16&255]+a[n>>24&255]},removeFromArray(e,t){if(!e||0==e.length)return e;const r=e.indexOf(t);return-1!==r&&e.splice(r,1),e},getNodeID:()=>i.hostname().toLowerCase()+"-"+t.pid,getIpList(){const e=[],t=[],r=i.networkInterfaces();for(let n in r)for(let o in r[n]){const i=r[n][o];if("IPv4"===i.family){if(i.internal){t.push(i.address);break}e.push(i.address);break}}return e.length>0?e:t},isPromise:e=>null!=e&&"function"==typeof e.then,polyfillPromise(e){d.isFunction(e.method)||(e.method=function(t){return function(){try{const r=t.apply(this,arguments);return e.resolve(r)}catch(t){return e.reject(t)}}}),d.isFunction(e.delay)||(e.delay=function(t){return new e((e=>r(e,+t)))},e.prototype.delay=function(t){return this.then((r=>e.delay(t).then((()=>r))))}),d.isFunction(e.prototype.timeout)||(e.TimeoutError=p,e.prototype.timeout=function(t,n){let o;const i=new e(((i,s)=>{o=r((()=>s(new e.TimeoutError(n))),+t)}));return e.race([i,this]).then((e=>(clearTimeout(o),e))).catch((e=>{throw clearTimeout(o),e}))}),d.isFunction(e.mapSeries)||(e.mapSeries=function(t,r){const n=Promise.method(r),o=[];return t.reduce(((e,t,r)=>e.then((e=>(o[r]=e,n(t,r))))),e.resolve()).then((e=>(o[t.length]=e,o.slice(1))))})},clearRequireCache(e){Object.keys(require.cache).forEach((function(t){t==e&&delete require.cache[t]}))},match(e,t){if(-1==t.indexOf("?")){const r=t.indexOf("*");if(-1==r)return t===e;const n=t.length;if(n>2&&t.endsWith("**")&&r>n-3)return t=t.substring(0,n-2),e.startsWith(t);if(n>1&&t.endsWith("*")&&r>n-2)return t=t.substring(0,n-1),!!e.startsWith(t)&&-1==e.indexOf(".",n);if(1==n&&0==r)return-1==e.indexOf(".");if(2==n&&0==r&&1==t.lastIndexOf("*"))return!0}const r=t;let n=c.get(r);return null==n&&(t.startsWith("$")&&(t="\\"+t),t="^"+(t=(t=(t=(t=t.replace(/\?/g,".")).replace(/\*\*/g,"§§§")).replace(/\*/g,"[^\\.]*")).replace(/§§§/g,".*"))+"$",n=new RegExp(t,""),c.set(r,n)),n.test(e)},deprecate(t,r){1==arguments.length&&(r=t),-1===f.indexOf(t)&&(console.warn(e.yellow().bold("DeprecationWarning: "+r)),f.push(t))},safetyObject:(e,t)=>JSON.parse(JSON.stringify(e,function(e={maxSafeObjectSize:1/0}){const t=new WeakSet;return function(r,n){if("object"==typeof n&&null!==n){const r=n.constructor&&n.constructor.name||typeof n;if(e.maxSafeObjectSize&&"length"in n&&n.length>e.maxSafeObjectSize)return`[${r} ${n.length}]`;if(e.maxSafeObjectSize&&"size"in n&&n.size>e.maxSafeObjectSize)return`[${r} ${n.size}]`;if(t.has(n))return;t.add(n)}return n}}(t))),dotSet(e,t,r){const n=t.split("."),o=n.shift();if(n.length>0){if(Object.prototype.hasOwnProperty.call(e,o)){if(null==e[o])e[o]={};else if("object"!=typeof e[o])throw new Error("Value already set and it's not an object")}else e[o]={};return e[o]=d.dotSet(e[o],n.join("."),r),e}return e[t]=r,e},makeDirs(e){e.split(n.sep).reduce(((e,t)=>{const r=n.join(e,t,n.sep);return s.existsSync(r)||s.mkdirSync(r),r}),"")},parseByteString(e){if("number"==typeof e&&!isNaN(e))return e;if("string"!=typeof e)return null;let t,r=u.exec(e),n="b";if(r)t=parseFloat(r[1]),n=r[4].toLowerCase();else{if(t=parseInt(e,10),Number.isNaN(t))return null;n="b"}return Math.floor(l[n]*t)}};var b=d;export default b;
//# sourceMappingURL=utils.js.map
