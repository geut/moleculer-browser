import{Buffer as e}from"buffer";import a from"../packets.js";var r=class{constructor(){}init(e){this.broker=e}serialize(){throw new Error("Not implemented method!")}deserialize(){throw new Error("Not implemented method!")}serializeCustomFields(e,r){switch(e){case a.PACKET_INFO:r.services=JSON.stringify(r.services),r.config&&(r.config=JSON.stringify(r.config)),r.metadata&&(r.metadata=JSON.stringify(r.metadata));break;case a.PACKET_EVENT:this.convertDataToTransport(r,"data","dataType"),r.meta=JSON.stringify(r.meta);break;case a.PACKET_REQUEST:this.convertDataToTransport(r,"params","paramsType"),r.meta=JSON.stringify(r.meta);break;case a.PACKET_RESPONSE:this.convertDataToTransport(r,"data","dataType"),r.meta=JSON.stringify(r.meta),r.error&&(r.error=JSON.stringify(r.error));break;case a.PACKET_GOSSIP_REQ:case a.PACKET_GOSSIP_RES:r.online&&(r.online=JSON.stringify(r.online)),r.offline&&(r.offline=JSON.stringify(r.offline))}return r}deserializeCustomFields(e,r){switch(e){case a.PACKET_INFO:r.services=JSON.parse(r.services),r.config&&(r.config=JSON.parse(r.config)),r.metadata&&(r.metadata=JSON.parse(r.metadata));break;case a.PACKET_EVENT:this.convertDataFromTransport(r,"data","dataType"),r.meta=JSON.parse(r.meta);break;case a.PACKET_REQUEST:this.convertDataFromTransport(r,"params","paramsType"),r.meta=JSON.parse(r.meta);break;case a.PACKET_RESPONSE:this.convertDataFromTransport(r,"data","dataType"),r.meta=JSON.parse(r.meta),r.error&&(r.error=JSON.parse(r.error));break;case a.PACKET_GOSSIP_REQ:case a.PACKET_GOSSIP_RES:r.online&&(r.online=JSON.parse(r.online)),r.offline&&(r.offline=JSON.parse(r.offline))}return r}convertDataToTransport(r,t,s){void 0===r[t]?r[s]=a.DATATYPE_UNDEFINED:null===r[t]?r[s]=a.DATATYPE_NULL:e.isBuffer(r[t])?r[s]=a.DATATYPE_BUFFER:(r[s]=a.DATATYPE_JSON,r[t]=e.from(JSON.stringify(r[t])))}convertDataFromTransport(r,t,s){switch(r[s]){case a.DATATYPE_UNDEFINED:r[t]=void 0;break;case a.DATATYPE_NULL:r[t]=null;break;case a.DATATYPE_BUFFER:e.isBuffer(r[t])||(r[t]=e.from(r[t]));break;default:r[t]=JSON.parse(r[t])}delete r[s]}};export default r;
//# sourceMappingURL=base.js.map
